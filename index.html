<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Star Background with Countdown</title>
<style>
  body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    height: 100vh;
    background-color: #000;
    font-family: sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    color: #fff;
    text-align: center;
    font-size: 2em;
  }
  b { font-weight: bold; }
  canvas {
    position: fixed;
    top: 0;
    left: 0;
    z-index: 0;
  }
  .content {
    position: relative;
    z-index: 1;
  }
</style>
</head>
<body>
<canvas id="starCanvas"></canvas>
<div class="content">
  <div id="countdown"></div>
</div>

<script>
  // ==== STAR BACKGROUND WITH CANVAS ====
  const canvas = document.getElementById('starCanvas');
  const ctx = canvas.getContext('2d');
  let width = canvas.width = window.innerWidth;
  let height = canvas.height = window.innerHeight;

  const starCount = 150;
  const stars = [];

  for (let i = 0; i < starCount; i++) {
    stars.push({
      x: Math.random() * width,
      y: Math.random() * height,
      size: Math.random() * 2 + 1,
      speedX: (Math.random() - 0.5) * 0.5,
      speedY: (Math.random() - 0.5) * 0.5,
      alpha: Math.random()
    });
  }

  let mouseVelX = 0;
  let mouseVelY = 0;
  let lastMouseX = 0;
  let lastMouseY = 0;

  document.addEventListener('mousemove', (e) => {
    mouseVelX = (e.clientX - lastMouseX) * 0.05;
    mouseVelY = (e.clientY - lastMouseY) * 0.05;
    lastMouseX = e.clientX;
    lastMouseY = e.clientY;
  });

  function animateStars() {
    ctx.clearRect(0, 0, width, height);
    for (let star of stars) {
      star.x += star.speedX + mouseVelX;
      star.y += star.speedY + mouseVelY;

      if (star.x < 0) star.x = width;
      if (star.x > width) star.x = 0;
      if (star.y < 0) star.y = height;
      if (star.y > height) star.y = 0;

      // twinkle
      star.alpha += (Math.random() - 0.5) * 0.05;
      if (star.alpha < 0) star.alpha = 0;
      if (star.alpha > 1) star.alpha = 1;

      ctx.globalAlpha = star.alpha;
      ctx.fillStyle = "#fff";
      ctx.beginPath();
      ctx.arc(star.x, star.y, star.size, 0, Math.PI * 2);
      ctx.fill();
    }
    ctx.globalAlpha = 1;
    requestAnimationFrame(animateStars);
  }

  animateStars();

  window.addEventListener('resize', () => {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
  });

  // ==== COUNTDOWN ====
  const weekdaySchedule = [
    {name:"A1/B1",start:510,end:590},
    {name:"A2/B2",start:595,end:675},
    {name:"1st Lunch",start:675,end:710},
    {name:"Quest (1st Lunch)",start:715,end:745},
    {name:"Quest (2nd Lunch)",start:680,end:710},
    {name:"2nd Lunch",start:710,end:745},
    {name:"A3/B3",start:750,end:830},
    {name:"A4/B4",start:835,end:915}
  ];

  const fridaySchedule = [
    {name:"Quest",start:510,end:570},
    {name:"A1/B1",start:575,end:625},
    {name:"A2/B2",start:630,end:680},
    {name:"1st Lunch",start:680,end:715},
    {name:"A3/B3 (1st Lunch)",start:720,end:770},
    {name:"A3/B3 (2nd Lunch)",start:685,end:735},
    {name:"2nd Lunch",start:735,end:770},
    {name:"A4/B4",start:775,end:825}
  ];

  function getCurrentPeriod() {
    const now = new Date();
    const day = now.getDay();
    const time = now.getHours()*60 + now.getMinutes();
    let schedule = (day>=1 && day<=4)?weekdaySchedule:(day===5?fridaySchedule:null);
    if(!schedule) return null;
    let current = schedule.find(p=>time>=p.start && time<p.end);
    if(!current) return null;
    if(current.name.includes("Quest")||current.name.includes("Lunch")||current.name.includes("A3/B3")){
      const options = schedule.filter(p=>p.name.startsWith(current.name.split(" ")[0]));
      if(options.length>1){
        let choice = prompt(`Which are you in?\n${options.map((o,i)=>`${i+1}. ${o.name}`).join("\n")}`);
        current = options[(parseInt(choice)-1)||0];
      }
    }
    return current;
  }

  function updateCountdown(){
    const current = getCurrentPeriod();
    const el = document.getElementById('countdown');
    if(!current){
      el.textContent = "No class right now ðŸŽ‰";
      document.title = "No class";
      return;
    }
    const now = new Date();
    const minutesNow = now.getHours()*60 + now.getMinutes();
    let totalSecsLeft = (current.end - minutesNow)*60 - now.getSeconds();
    if(totalSecsLeft < 0) totalSecsLeft = 0;
    const mins = Math.floor(totalSecsLeft/60);
    const secs = totalSecsLeft%60;
    el.innerHTML = `${mins} min ${secs} sec left till <b>${current.name}</b> is over`;
    document.title = `${mins}m ${secs}s left`;
  }

  updateCountdown();
  setInterval(updateCountdown, 1000);
</script>
</body>
</html>
